### Инструменты
- #### Python 3.12.8, pydantic, python-dotenv, sqlite3, aiogram, redis (для FSM), selenium
- #### asyncio
- #### Type annotations
- #### Dockerfile, docker-compose
- #### Логгирование (logging)

### Disclaimer / Краткие пояснения, которые я обязан оставить
- В ТЗ было сказано, что нужно сохранить файл, но не было сказано куда, поэтому я сохраняю в **io.BytesIO** и читаю "на лету", без сохранения в файловую систему.
- Подключение к БД по-хорошему нужно внедрять как зависимость, чтобы на каждый хэндлер было 1 соединение. Сейчас, в силу того, что это ТЗ, подключаемся к БД "на ходу".
- В проде может пойти не так всё что угодно: потеряться соединение с БД, отключится интернет, переполнится ЖД или ОЗУ и т.д.,
поэтому в реальном мире делаем middleware (или другое решение) для обработки всех возможных ошибок.
- src/myfile.xls - файл для примера.
- Задание со *: парсер. Сделал через selenium, т.к. большинство сайтов имеют подгрузку данных после загрузки страницы.
- Само ТЗ простое, не требует много времени для выполнения, но в то же время - есть места для маневров, так как многие вещи нужно делать на свой вкус и цвет) Thanks!
P.S. Если есть вопросы - tg: sanches005
### Структура проекта
#### bot - пакет, относящийся к работе telegram бота
 - main - точка запуска бота: инициализация бота, регистрация хэндлеров, конфигурирование логгирования, запуск бота
 - constants - шаблоны для кнопок/сообщений
 - filters - магические фильтры aiogram для обработчиков
 - handlers - обработчики сообщений, коллбэков
 - keyboards - клавиатуры, используемые в боте
 - services - бизнес-логика обработчиков
 - states - состояния для FSM
 - utils - вспомогательные функции-утилитки
#### db - пакет относящийся к работе с БД
 - connection - логика для подключения к БД
 - dals - описана логика, через которую происходит доступ к данным БД (слой доступа к данным)
 - schemas - описаны pydantic модели, в которых которых храним сущности БД
#### files - пакет относящийся к работе с файлами
 - files - абстракция файла
 - excel - модуль для работы с excel файлами (абстракция Excel файла и readers)
 - exceptions - кастомные исключения
#### parser - пакет, относящийся к парсингу
 - services - бизнес-логика логика, которая запускает парсинг
 - utils - вспомогательные функции для парсера
 - tests - тесты
#### settings - настройки проекта
 - config - основной модуль, содержащий настройки: переменные окружения и константы
 - logger - модуль, который задает конфиг для logging, устанавливает уровень логгирования, цвета, формат логов и т.д.
 - utils - вспомогательные функции для получения настроек
#### .env.template - шаблон файла .env, с необходимыми переменными окружения для работы проекта
#### create_tables.sql - SQL код создания необходимой структуры БД
#### myfile.xls - тестовый excel-файл

### How to use
#### ! Разработка велась на Ubuntu 24.04 и, соответственно, инструкция под это
#### 1. Склонировать репозиторий к себе и перейдите в папку с проектом.
#### 2. В папке `src/` создать файл `.env`, затем скопировать в него содержимое из `src/.env.template`.
#### 3. Заполнить созданный `src/.env` файл необходимыми значениями. 
#### 4. Выбрать след.шаг (либо с использование docker-compose либо вручную)

- ### Запуск с использованием docker-compose (!!! в первый раз будет долго скачивать selenium образ ~1.9GB):
1. Для того, чтобы настроить redis, в файле `src/.env`:
   - проставить значение `technesis-redis` для `REDIS_HOST`;
   - проставить значение `6379` для `REDIS_PORT`;
2. В корневой папке репозитория (там где docker-compose.yaml) выполнить команду:
    ```shell
    docker compose up --build
    ```
- ### Запуск без использования docker-compose:
1. Запустить **redis**, например, через docker (на свободном порту на вашей машине, для примера взят порт 6390):
   ```shell
   docker run -d --restart unless-stopped -p 6390:6379 -d redis:7.4.2-alpine
   ```
2. Установить **sqlite3**:
   ```shell
   apt install sqlite3
   ```
3. Перейти в папку `src/`
4. В файле `.env` переменную `REDIS_PORT` установить порт, на котором запущен **redis**
5. Инициализировать БД, выполнив команду:
   ```shell
   sqlite3 technesis.sqlite3 < create_tables.sql || true
   ```
6. Создать виртуальное окружение, активировать и установить зависимости:
   ```shell
   python3 -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   ```
7. Установить рабочую директорию, выполнив команду **находясь в папке `src/`**:
   ```shell
   export PYTHONPATH=$PYTHONPATH:$(pwd)
   ```
8. Запустить бот:
   ```
   python bot/main.py
   ```
